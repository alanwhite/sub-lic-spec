# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================
APP_ENV=development
APP_DEBUG=true
APP_URL=https://license-server.local
APP_PORT=8443

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
DB_CONNECTION=mysql
DB_HOST=db
DB_PORT=3306
DB_DATABASE=license_system
DB_USERNAME=license_user
DB_PASSWORD=secure_password_here_change_me

# ============================================================================
# PRIVATE CA CONFIGURATION
# ============================================================================
# Root CA (Offline, 20-year validity)
CA_ROOT_CERT_PATH=/etc/ca/root-ca/certs/root-ca.crt
CA_ROOT_KEY_PATH=/etc/ca/root-ca/private/root-ca.key
CA_ROOT_KEY_PASSWORD=root_ca_password_here_change_me

# Intermediate CA (Online, 10-year validity)
CA_INTERMEDIATE_CERT_PATH=/etc/ca/intermediate-ca/certs/intermediate-ca.crt
CA_INTERMEDIATE_KEY_PATH=/etc/ca/intermediate-ca/private/intermediate-ca.key
CA_INTERMEDIATE_KEY_PASSWORD=intermediate_ca_password_here_change_me

# CA Directories
CA_ISSUED_CERTS_DIR=/etc/ca/issued-certificates
CA_CRL_PATH=/var/www/html/public/crl/current.crl
CA_CRL_UPDATE_INTERVAL=86400  # 24 hours in seconds

# ============================================================================
# LICENSE SIGNING KEYS (Separate from CA keys)
# ============================================================================
LICENSE_SIGNING_KEY_PATH=/etc/license-server/license-signing.key
LICENSE_SIGNING_KEY_PASSWORD=license_key_password_here_change_me
LICENSE_SIGNING_PUB_PATH=/etc/license-server/license-signing.pub

# ============================================================================
# TLS/SSL CONFIGURATION
# ============================================================================
# Server certificate (from public CA for production)
TLS_CERT_PATH=/etc/ssl/certs-custom/server.crt
TLS_KEY_PATH=/etc/ssl/certs-custom/server.key

# TLS endpoint (no client cert required)
TLS_PORT=8443

# mTLS endpoint (client cert required)
MTLS_PORT=9443

# ============================================================================
# SECURITY
# ============================================================================
# JWT secret for session tokens (NOT license tokens)
JWT_SECRET=random_secret_key_here_32_chars_minimum_change_in_production

# Encryption key for sensitive data (32 bytes)
ENCRYPTION_KEY=32_byte_encryption_key_here_change_in_production_exactly_32

# ============================================================================
# SUBSCRIPTION & GRACE PERIODS
# ============================================================================
# Grace period after subscription expiration (days)
GRACE_PERIOD_MONTHLY=5
GRACE_PERIOD_ANNUAL=14

# Device limits (can be overridden per subscription)
DEFAULT_DEVICE_LIMIT=1

# ============================================================================
# CERTIFICATE VALIDITY
# ============================================================================
CERTIFICATE_VALIDITY_YEARS=2
CERTIFICATE_RENEWAL_DAYS=30  # Start renewal window 30 days before expiry

# ============================================================================
# RATE LIMITING
# ============================================================================
# Enrollment tokens
RATE_LIMIT_ENROLLMENT_TOKENS=5  # Max tokens per 24 hours
RATE_LIMIT_ENROLLMENT_WINDOW=86400  # 24 hours in seconds

# License operations
RATE_LIMIT_LICENSE=100  # Max license operations per hour
RATE_LIMIT_LICENSE_WINDOW=3600  # 1 hour in seconds

# ============================================================================
# LOGGING
# ============================================================================
LOG_LEVEL=debug  # debug, info, warning, error
LOG_PATH=/var/log/license-server/app.log
AUDIT_LOG_PATH=/var/log/license-server/audit.log
LOG_MAX_SIZE=10485760  # 10 MB
LOG_MAX_FILES=10

# ============================================================================
# EXTERNAL SERVICES (Optional)
# ============================================================================
# Payment provider integration
PAYMENT_PROVIDER=stripe  # stripe, paypal, etc.
PAYMENT_PROVIDER_API_KEY=
PAYMENT_PROVIDER_WEBHOOK_SECRET=

# ============================================================================
# EMAIL NOTIFICATIONS (Optional)
# ============================================================================
MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=
MAIL_PASSWORD=
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=noreply@license-server.com
MAIL_FROM_NAME="License Server"

# ============================================================================
# MONITORING & ANALYTICS (Optional)
# ============================================================================
SENTRY_DSN=
ANALYTICS_ENABLED=false